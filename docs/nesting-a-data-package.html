<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>NCEAS Data Team Training</title>
  <meta name="description" content="This is a training guide and reference resource for NCEAS data team members working on the SASAP and Arctic Data Center Projects">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="NCEAS Data Team Training" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a training guide and reference resource for NCEAS data team members working on the SASAP and Arctic Data Center Projects" />
  <meta name="github-repo" content="rstudio/datateam-training" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="NCEAS Data Team Training" />
  
  <meta name="twitter:description" content="This is a training guide and reference resource for NCEAS data team members working on the SASAP and Arctic Data Center Projects" />
  

<meta name="author" content="Jeanette Clark, Jesse Goldstein, Dominic Mullen, Bryce Mecum, Matt Jones, Peter Slaughter">


<meta name="date" content="2018-01-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction-to-solr.html">
<link rel="next" href="building-provenance.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to NCEAS!</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#first-day-to-dos"><i class="fa fa-check"></i><b>1.1</b> First day to-dos</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#account-information"><i class="fa fa-check"></i><b>1.2</b> Account information</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#nceas-events"><i class="fa fa-check"></i><b>1.3</b> NCEAS Events</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html"><i class="fa fa-check"></i><b>2</b> Introduction to open science</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#open-science-background-reading"><i class="fa fa-check"></i><b>2.1</b> Open science background reading</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#effective-data-management"><i class="fa fa-check"></i><b>2.2</b> Effective data management</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#using-dataone"><i class="fa fa-check"></i><b>2.3</b> Using DataONE</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#working-on-a-remote-server"><i class="fa fa-check"></i><b>2.4</b> Working on a remote server</a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#cyberduck-instructions"><i class="fa fa-check"></i><b>2.4.1</b> Cyberduck instructions</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#a-note-on-paths"><i class="fa fa-check"></i><b>2.4.2</b> A note on paths</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#exercise1"><i class="fa fa-check"></i><b>2.4.3</b> Exercise 1</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html"><i class="fa fa-check"></i><b>3</b> Using arcticdatautils</a><ul>
<li class="chapter" data-level="3.1" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#uploading-packages-using-r"><i class="fa fa-check"></i><b>3.1</b> Uploading packages using R</a><ul>
<li class="chapter" data-level="3.1.1" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#set-environment"><i class="fa fa-check"></i><b>3.1.1</b> Set environment</a></li>
<li class="chapter" data-level="3.1.2" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#what-is-in-a-package"><i class="fa fa-check"></i><b>3.1.2</b> What is in a package?</a></li>
<li class="chapter" data-level="3.1.3" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#about-identifiers"><i class="fa fa-check"></i><b>3.1.3</b> About identifiers</a></li>
<li class="chapter" data-level="3.1.4" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#publishing-a-package-to-the-site"><i class="fa fa-check"></i><b>3.1.4</b> Publishing a package to the site</a></li>
<li class="chapter" data-level="3.1.5" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#exercise2"><i class="fa fa-check"></i><b>3.1.5</b> Exercise 2</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#uploading-a-new-version"><i class="fa fa-check"></i><b>3.2</b> Uploading a new version</a><ul>
<li class="chapter" data-level="3.2.1" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#exercise3"><i class="fa fa-check"></i><b>3.2.1</b> Exercise 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="system-metadata.html"><a href="system-metadata.html"><i class="fa fa-check"></i><b>4</b> System metadata</a><ul>
<li class="chapter" data-level="4.1" data-path="system-metadata.html"><a href="system-metadata.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="system-metadata.html"><a href="system-metadata.html#editing-sysmeta"><i class="fa fa-check"></i><b>4.2</b> Editing sysmeta</a><ul>
<li class="chapter" data-level="4.2.1" data-path="system-metadata.html"><a href="system-metadata.html#exercise4"><i class="fa fa-check"></i><b>4.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="system-metadata.html"><a href="system-metadata.html#editing-sysmeta-on-lots-of-files"><i class="fa fa-check"></i><b>4.3</b> Editing sysmeta on lots of files</a></li>
<li class="chapter" data-level="4.4" data-path="system-metadata.html"><a href="system-metadata.html#identifiers-and-sysmeta"><i class="fa fa-check"></i><b>4.4</b> Identifiers and sysmeta</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html"><i class="fa fa-check"></i><b>5</b> Editing EML in R</a><ul>
<li class="chapter" data-level="5.1" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#making-edits"><i class="fa fa-check"></i><b>5.2</b> Making edits</a><ul>
<li class="chapter" data-level="5.2.1" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#setting-attributes"><i class="fa fa-check"></i><b>5.2.1</b> Setting attributes</a></li>
<li class="chapter" data-level="5.2.2" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#setting-other-entities"><i class="fa fa-check"></i><b>5.2.2</b> Setting other entities</a></li>
<li class="chapter" data-level="5.2.3" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#setting-coverages"><i class="fa fa-check"></i><b>5.2.3</b> Setting coverages</a></li>
<li class="chapter" data-level="5.2.4" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#setting-methods"><i class="fa fa-check"></i><b>5.2.4</b> Setting methods</a></li>
<li class="chapter" data-level="5.2.5" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#adding-people"><i class="fa fa-check"></i><b>5.2.5</b> Adding people</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#validating-and-writing-the-eml"><i class="fa fa-check"></i><b>5.3</b> Validating and writing the EML</a></li>
<li class="chapter" data-level="5.4" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#dealing-with-unusual-cases"><i class="fa fa-check"></i><b>5.4</b> Dealing with unusual cases</a></li>
<li class="chapter" data-level="5.5" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#exercise5"><i class="fa fa-check"></i><b>5.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html"><i class="fa fa-check"></i><b>6</b> Using Git in RStudio</a><ul>
<li class="chapter" data-level="6.1" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#so-why-do-i-need-to-use-this-again"><i class="fa fa-check"></i><b>6.1.1</b> So why do I need to use this again?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#setting-up-git"><i class="fa fa-check"></i><b>6.2</b> Setting up git</a><ul>
<li class="chapter" data-level="6.2.1" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#cloning-the-arctic-data-repo"><i class="fa fa-check"></i><b>6.2.1</b> Cloning the arctic-data repo</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#working-with-the-repository"><i class="fa fa-check"></i><b>6.3</b> Working with the repository</a><ul>
<li class="chapter" data-level="6.3.1" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#adding-a-new-script"><i class="fa fa-check"></i><b>6.3.1</b> Adding a new script</a></li>
<li class="chapter" data-level="6.3.2" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#editing-a-script"><i class="fa fa-check"></i><b>6.3.2</b> Editing a script</a></li>
<li class="chapter" data-level="6.3.3" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#where-do-i-commit"><i class="fa fa-check"></i><b>6.3.3</b> Where do I commit?</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#my-git-tab-disappeared"><i class="fa fa-check"></i><b>6.4</b> My Git tab disappeared</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="using-rt.html"><a href="using-rt.html"><i class="fa fa-check"></i><b>7</b> Using RT</a><ul>
<li class="chapter" data-level="7.1" data-path="using-rt.html"><a href="using-rt.html#navigating-rt"><i class="fa fa-check"></i><b>7.1</b> Navigating RT</a><ul>
<li class="chapter" data-level="7.1.1" data-path="using-rt.html"><a href="using-rt.html#frontpage"><i class="fa fa-check"></i><b>7.1.1</b> Front Page</a></li>
<li class="chapter" data-level="7.1.2" data-path="using-rt.html"><a href="using-rt.html#alltickets"><i class="fa fa-check"></i><b>7.1.2</b> All Tickets</a></li>
<li class="chapter" data-level="7.1.3" data-path="using-rt.html"><a href="using-rt.html#exampleticket"><i class="fa fa-check"></i><b>7.1.3</b> Example Ticket</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="using-rt.html"><a href="using-rt.html#email-templates"><i class="fa fa-check"></i><b>7.2</b> Email templates</a><ul>
<li class="chapter" data-level="7.2.1" data-path="using-rt.html"><a href="using-rt.html#initial-response"><i class="fa fa-check"></i><b>7.2.1</b> Initial response</a></li>
<li class="chapter" data-level="7.2.2" data-path="using-rt.html"><a href="using-rt.html#title-needs-work"><i class="fa fa-check"></i><b>7.2.2</b> Title needs work</a></li>
<li class="chapter" data-level="7.2.3" data-path="using-rt.html"><a href="using-rt.html#abstract-comments"><i class="fa fa-check"></i><b>7.2.3</b> Abstract comments</a></li>
<li class="chapter" data-level="7.2.4" data-path="using-rt.html"><a href="using-rt.html#best-practices"><i class="fa fa-check"></i><b>7.2.4</b> Best practices</a></li>
<li class="chapter" data-level="7.2.5" data-path="using-rt.html"><a href="using-rt.html#methods"><i class="fa fa-check"></i><b>7.2.5</b> Methods</a></li>
<li class="chapter" data-level="7.2.6" data-path="using-rt.html"><a href="using-rt.html#data-files"><i class="fa fa-check"></i><b>7.2.6</b> Data files</a></li>
<li class="chapter" data-level="7.2.7" data-path="using-rt.html"><a href="using-rt.html#doi-and-data-set-finalization-comments"><i class="fa fa-check"></i><b>7.2.7</b> DOI and data set finalization comments</a></li>
<li class="chapter" data-level="7.2.8" data-path="using-rt.html"><a href="using-rt.html#nsf-arc-data-submission-policy"><i class="fa fa-check"></i><b>7.2.8</b> NSF ARC data submission policy</a></li>
<li class="chapter" data-level="7.2.9" data-path="using-rt.html"><a href="using-rt.html#nesting"><i class="fa fa-check"></i><b>7.2.9</b> Nesting</a></li>
<li class="chapter" data-level="7.2.10" data-path="using-rt.html"><a href="using-rt.html#finding-multiple-data-sets"><i class="fa fa-check"></i><b>7.2.10</b> Finding multiple data sets</a></li>
<li class="chapter" data-level="7.2.11" data-path="using-rt.html"><a href="using-rt.html#asking-for-approval"><i class="fa fa-check"></i><b>7.2.11</b> Asking for approval</a></li>
<li class="chapter" data-level="7.2.12" data-path="using-rt.html"><a href="using-rt.html#other-faqs"><i class="fa fa-check"></i><b>7.2.12</b> Other FAQs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html"><i class="fa fa-check"></i><b>8</b> Introduction to Solr</a><ul>
<li class="chapter" data-level="8.1" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#querying-solr"><i class="fa fa-check"></i><b>8.1</b> Querying Solr</a><ul>
<li class="chapter" data-level="8.1.1" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#parts-of-a-query"><i class="fa fa-check"></i><b>8.1.1</b> Parts of a Query</a></li>
<li class="chapter" data-level="8.1.2" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#constructing-a-query"><i class="fa fa-check"></i><b>8.1.2</b> Constructing a Query</a></li>
<li class="chapter" data-level="8.1.3" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#faceting"><i class="fa fa-check"></i><b>8.1.3</b> Faceting</a></li>
<li class="chapter" data-level="8.1.4" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#stats"><i class="fa fa-check"></i><b>8.1.4</b> Stats</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#querying-solr-through-r"><i class="fa fa-check"></i><b>8.2</b> Querying Solr through R</a></li>
<li class="chapter" data-level="8.3" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#key-takeaways"><i class="fa fa-check"></i><b>8.3</b> Key takeaways</a></li>
<li class="chapter" data-level="8.4" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#more-resources"><i class="fa fa-check"></i><b>8.4</b> More resources</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="nesting-a-data-package.html"><a href="nesting-a-data-package.html"><i class="fa fa-check"></i><b>9</b> Nesting a data package</a><ul>
<li class="chapter" data-level="9.1" data-path="nesting-a-data-package.html"><a href="nesting-a-data-package.html#introduction-3"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="nesting-a-data-package.html"><a href="nesting-a-data-package.html#exercise"><i class="fa fa-check"></i><b>9.2</b> Exercise</a></li>
<li class="chapter" data-level="9.3" data-path="nesting-a-data-package.html"><a href="nesting-a-data-package.html#creating-a-parent"><i class="fa fa-check"></i><b>9.3</b> Creating a Parent</a></li>
<li class="chapter" data-level="9.4" data-path="nesting-a-data-package.html"><a href="nesting-a-data-package.html#adding-a-child-to-a-pre-existing-parent"><i class="fa fa-check"></i><b>9.4</b> Adding a child to a pre-existing parent</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="building-provenance.html"><a href="building-provenance.html"><i class="fa fa-check"></i><b>10</b> Building Provenance</a><ul>
<li class="chapter" data-level="10.1" data-path="building-provenance.html"><a href="building-provenance.html#introduction-4"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="building-provenance.html"><a href="building-provenance.html#the-prov-editor"><i class="fa fa-check"></i><b>10.2</b> The Prov Editor</a></li>
<li class="chapter" data-level="10.3" data-path="building-provenance.html"><a href="building-provenance.html#datapack"><i class="fa fa-check"></i><b>10.3</b> <code>datapack</code></a><ul>
<li class="chapter" data-level="10.3.1" data-path="building-provenance.html"><a href="building-provenance.html#fixing-mistakes"><i class="fa fa-check"></i><b>10.3.1</b> Fixing mistakes</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="building-provenance.html"><a href="building-provenance.html#references"><i class="fa fa-check"></i><b>10.4</b> References</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NCEAS Data Team Training</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nesting-a-data-package" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Nesting a data package</h1>
<div id="introduction-3" class="section level2">
<h2><span class="header-section-number">9.1</span> Introduction</h2>
<p>This document is a practical tutorial for creating nesting relationships between data packages on the DataONE member nodes (MNs).</p>
<p>Data packages on MNs can exist as independent packages or in groups (nested data packages). Much like we can group multiple data files together with a common metadata file, we can group related data packages together with a common “parent” data package.</p>
<p>The structure of nested data packages resembles a pyramid. There is one top level, or “parent”, with one or more data packages, or “children”, nested beneath it. There is no limit to how many nested levels can be created, but packages do not generally exceed 3 levels. This <a href="https://arcticdata.io/catalog/#view/urn:uuid:b0eef8b3-5f8a-4799-b823-eebcbee047e3">example</a> has three levels. The link will take you to the top level, or “grandparent”. This top level has 5 children (nested datasets). If you click on any one of these children you can see that they have children of their own.</p>
<p>Some common uses for nesting:</p>
<ul>
<li>collected data vary by year</li>
<li>an NSF award funds several related projects</li>
<li>data collection is still ongoing</li>
<li>data files exceed the 1000 file limit per data package</li>
</ul>
</div>
<div id="exercise" class="section level2">
<h2><span class="header-section-number">9.2</span> Exercise</h2>
<p>We will create two data packages on the test node to nest beneath a parent. These data packages contain measurements taken from Lake E1 in Alaska in 2013 and 2014.</p>
<p>First, load the Arctic Data Center Test Node and libraries.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dataone)
<span class="kw">library</span>(arcticdatautils)
<span class="kw">library</span>(EML)
cnTest &lt;-<span class="st"> </span><span class="kw">CNode</span>(<span class="st">&#39;STAGING&#39;</span>)
mnTest &lt;-<span class="st"> </span><span class="kw">getMNode</span>(cnTest,<span class="st">&#39;urn:node:mnTestARCTIC&#39;</span>)</code></pre></div>
<ul>
<li>We can publish several data files at once using the <code>dir</code> and <code>sapply</code> functions. <code>dir</code> returns the paths to every file located in a folder.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dir</span>(<span class="st">&quot;data/2013&quot;</span>, <span class="dt">full.names =</span> T)</code></pre></div>
<pre><code>## [1] &quot;data/2013/2012_2013_winter_E1_temperature.csv&quot;
## [2] &quot;data/2013/2013_summer_E1_temperature.csv&quot;</code></pre>
<ul>
<li>We can use <code>sapply</code> to apply a function over a list or vector. In this instance we will use it to apply <code>publish_object</code> over the vector of files paths (paths_2013) in order to publish them.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">paths_2013 &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;/home/dmullen/Nesting_Training/2013&quot;</span>, <span class="dt">full.names =</span> T)
data_2013 &lt;-<span class="st"> </span><span class="kw">sapply</span>(paths_2013, function(path) { <span class="kw">publish_object</span>(mnTest, path, <span class="dt">format =</span> <span class="st">&quot;text/csv&quot;</span>) })</code></pre></div>
<ul>
<li>Publish the metadata file to the test node using <code>publish_object</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">metadata2013 &lt;-<span class="st"> </span><span class="kw">publish_object</span>(mnTest,
                               <span class="dt">path =</span> <span class="st">&quot;/home/dmullen/Nesting_Training/E1_2013metadata.xml&quot;</span>,
                               <span class="dt">format =</span> <span class="kw">format_eml</span>())</code></pre></div>
<ul>
<li>Create a resource map to associate the data with the metadata. Here we specify the metadata and data identifiers (PIDs) that we would like the resource map to associate together. These are the identifiers of the objects we just published to the test node.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resourceMap2013 &lt;-<span class="st"> </span><span class="kw">create_resource_map</span>(mnTest,
                                       <span class="dt">metadata_pid =</span> metadata2013,
                                       <span class="dt">data_pids =</span> data2013)</code></pre></div>
<ul>
<li>Repeat the same steps as above for the 2014 data package.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">paths_2014 &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;/home/dmullen/Nesting_Training/2014&quot;</span>, <span class="dt">full.names =</span> T)
data_2014 &lt;-<span class="st"> </span><span class="kw">sapply</span>(paths_2014, function(path) { <span class="kw">publish_object</span>(mnTest, path, <span class="dt">format =</span> <span class="st">&quot;text/csv&quot;</span>) })
metadata2014 &lt;-<span class="st"> </span><span class="kw">publish_object</span>(mnTest, <span class="dt">path =</span> <span class="st">&quot;/home/dmullen/Nesting_Training/E1_2014metadata.xml&quot;</span>, <span class="dt">format =</span> <span class="kw">format_eml</span>())
resourceMap2014 &lt;-<span class="st"> </span><span class="kw">create_resource_map</span>(mnTest, <span class="dt">metadata_pid =</span> metadata2014, <span class="dt">data_pids =</span> data2014)</code></pre></div>
<p>These two packages correspond to data from the same study, varying only by year; however, they currently exist on the test node as independent entities. We will associate them with each other by nesting them underneath a parent. <em>Note:</em> Data packages are usually not entirely uploaded through the R client. Typically a PI will submit the metadata and data, and the resource map is automatically generated by the node.</p>
</div>
<div id="creating-a-parent" class="section level2">
<h2><span class="header-section-number">9.3</span> Creating a Parent</h2>
<p>In some cases a parent package already exists. Search the ADC for the NSF award number to see if there are already exisiting packages. Parents usually have a <code>UUID</code> rather than a <code>DOI</code> and often start with a title like “Collaborative research:”, but not always. More typically, you will need to create a new parent by editing the existing metadata. The parent package should contain a generalized summary for the metadata of each of its children. It typically does not contain any data itself. We will now generalize a metadata file from one of the children in order to create the parent.</p>
<ul>
<li>Read in one of the children’s metadata files (EML), in this case 2013.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eml_parent &lt;-<span class="st"> </span><span class="kw">read_eml</span>(<span class="st">&quot;data/E1_2013metadata.xml&quot;</span>)
## Use this code when you are reading in the parent 
<span class="co"># eml_parent &lt;- read_eml(&quot;/home/dmullen/Nesting_Training/E1_2013metadata.xml&quot;)</span>
## View the title 
eml_parent@dataset@title</code></pre></div>
<pre><code>## An object of class &quot;ListOftitle&quot;
## [[1]]
## &lt;title&gt;Time series of water temperature, specific conductance and oxygen from Lake E1, North Slope, Alaska, 2012-2013.&lt;/title&gt;</code></pre>
<ul>
<li>The title of this child contains “2012-2013”. This is too specific for the parent, as the temporal range of both children is 2012-2014. The parent should encompass this larger time range.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eml_parent@dataset@title &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">new</span>(<span class="st">&quot;title&quot;</span>,
                                  <span class="dt">.Data =</span> <span class="st">&quot;Time series of water temperature, specific conductance, and oxygen from Lake E1, North Slope, Alaska, 2012-2014&quot;</span>))</code></pre></div>
<ul>
<li>Like the title, the temporal coverage elements in this EML need to be adjusted. This field depends on whether or not the project has been completed.<br />
+If the project is ongoing and the PI plans on submitting data in the future, set the Temporal Coverage to the start date of the project using a <code>singleDateTime</code> element. We leave it open-ended and do not include an ending date.<br />
+If the project has been completed, set the Temporal Coverage to the start and end dates of the entire study. *In this case lets assume the project has been completed. We will update the temporal coverage to reflect the entire duration of the study. Since we are using the metadata from the first year of the project, we only need to update the <code>endDate</code> element.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eml_parent@dataset@coverage@temporalCoverage@.Data[[<span class="dv">1</span>]]@rangeOfDates@endDate@calendarDate &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;calendarDate&quot;</span>,
                                                                                                 <span class="st">&quot;2014-09-20&quot;</span>)</code></pre></div>
<ul>
<li>Remove <code>dataTable</code>s and <code>otherEntity</code>s from the metadata. If you recall from previous chapters, <code>dataTable</code>s contain metadata associated with data files (generally CSVs) and <code>otherEntity</code>s contain metadata about any other files in the data package (for instance a readMe or coding script). Because the parent does not contain any data objects, we want to remove <code>dataTables</code> and <code>otherEntities</code> from the metdata file. In this instance, the E1 2013 metadata only contains <code>dataTable</code>s. We can remove these by setting the <code>dataTable</code> element in the EML to a new blank object.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eml_parent@dataset@dataTable &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;ListOfdataTable&quot;</span>)</code></pre></div>
<ul>
<li><p>In most cases elements like the abstract, contacts, creators, geographic description, and methods are already generalized and do not require changes.</p></li>
<li><p>Before writing your parent EML make sure that it validates. This is just a check to make sure everything is in the correct format.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">eml_validate</span>(eml_parent)</code></pre></div>
<ul>
<li>After your EML validates we need to save, or “write”, it as a new file. Write your parent EML to a directory in your home folder. You can view this process like using “Save as” in Microsoft Word. We opened a file (E1_2013.xml), made some changes, and “saved it as” a new file called eml_parent.xml.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## This will create the file &quot;eml_parent.xml&quot; at the location specified by path
path =<span class="st"> &quot;/home/YOURUSERNAME/eml_parent.xml&quot;</span>
<span class="kw">write_eml</span>(eml_parent, path)</code></pre></div>
<ul>
<li>Next, we will publish the parent metadata to the test node.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">metadata_parent &lt;-<span class="st"> </span><span class="kw">publish_object</span>(mnTest, <span class="dt">path =</span> path, <span class="dt">format_id =</span> <span class="kw">format_eml</span>())</code></pre></div>
<p>Finally, we create a resource map for the parent package. We nest the two child data packages using the <code>child_pids</code> argument in <code>create_resource_map</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resourceMap_parent &lt;-<span class="st"> </span><span class="kw">create_resource_map</span>(mnTest, 
                                          <span class="dt">metadata_pid =</span> metadata_parent,
                                          <span class="dt">child_pids =</span> <span class="kw">c</span>(resourceMap2013, resourceMap2014))</code></pre></div>
<p>The child packages are now nested underneath the parent.</p>
</div>
<div id="adding-a-child-to-a-pre-existing-parent" class="section level2">
<h2><span class="header-section-number">9.4</span> Adding a child to a pre-existing parent</h2>
<p>In some cases you will need to nest a new child underneath an existing parent. In this case we will nest the 2015 data for Lake E1 with our existing data package.</p>
<ul>
<li>First, create the 2015 child package.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">paths_2015 &lt;-<span class="st"> </span><span class="kw">dir</span>(<span class="st">&quot;/home/dmullen/Nesting_Training/2015&quot;</span>, <span class="dt">full.names =</span> T)
data_2015 &lt;-<span class="st"> </span><span class="kw">sapply</span>(paths_2015, function(path) { <span class="kw">publish_object</span>(mnTest, path, <span class="dt">format =</span> <span class="st">&quot;text/csv&quot;</span>) })
metadata2015 &lt;-<span class="st"> </span><span class="kw">publish_object</span>(mnTest, <span class="dt">path =</span> <span class="st">&quot;/home/dmullen/Nesting_Training/E1_2015metadata.xml&quot;</span>, <span class="dt">format =</span> <span class="kw">format_eml</span>())
resourceMap2015 &lt;-<span class="st"> </span><span class="kw">create_resource_map</span>(mnTest, <span class="dt">metadata_pid =</span> metadata2015, <span class="dt">data_pids =</span> data2015)</code></pre></div>
<ul>
<li>Nest the new child using the <code>child_pids</code> argument in <code>update_resource_map()</code>. Note: it’s important to include the <em>resource map PIDs of ALL the children</em> in the <code>child_pids</code> argument, otherwise the nesting relationships between any omitted children and the parent will be deleted.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resourceMap_parent2 &lt;-<span class="st"> </span><span class="kw">update_resource_map</span>(mnTest, 
                                           <span class="dt">resource_map_pid =</span> resourceMap_parent,
                                           <span class="dt">metadata_pid =</span> metadata_parent)</code></pre></div>
<ul>
<li>Nesting relationships can also be modified using the <code>child_pids</code> argument in <code>publish_update</code> in the same manner.</li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-solr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="building-provenance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>

<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>NCEAS Data Team Training</title>
  <meta name="description" content="This is a training guide and reference resource for NCEAS data team members working on the SASAP and Arctic Data Center Projects">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="NCEAS Data Team Training" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a training guide and reference resource for NCEAS data team members working on the SASAP and Arctic Data Center Projects" />
  <meta name="github-repo" content="rstudio/datateam_training" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="NCEAS Data Team Training" />
  
  <meta name="twitter:description" content="This is a training guide and reference resource for NCEAS data team members working on the SASAP and Arctic Data Center Projects" />
  

<meta name="author" content="Jeanette Clark, Jesse Goldstein, Dominic Mullen, Bryce Mecum">


<meta name="date" content="2017-12-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="introduction-to-open-science.html">
<link rel="next" href="system-metadata.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Welcome to NCEAS!</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#first-day-to-dos"><i class="fa fa-check"></i><b>1.1</b> First day to-dos</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#account-information"><i class="fa fa-check"></i><b>1.2</b> Account information</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#nceas-events"><i class="fa fa-check"></i><b>1.3</b> NCEAS Events</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html"><i class="fa fa-check"></i><b>2</b> Introduction to open science</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#open-science-background-reading"><i class="fa fa-check"></i><b>2.1</b> Open science background reading</a></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#effective-data-management"><i class="fa fa-check"></i><b>2.2</b> Effective data management</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#using-dataone"><i class="fa fa-check"></i><b>2.3</b> Using DataONE</a></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#working-on-a-remote-server"><i class="fa fa-check"></i><b>2.4</b> Working on a remote server</a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#cyberduck-instructions"><i class="fa fa-check"></i><b>2.4.1</b> Cyberduck instructions</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#a-note-on-paths"><i class="fa fa-check"></i><b>2.4.2</b> A note on paths</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-open-science.html"><a href="introduction-to-open-science.html#exercise1"><i class="fa fa-check"></i><b>2.4.3</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html"><i class="fa fa-check"></i><b>3</b> Using arcticdatautils</a><ul>
<li class="chapter" data-level="3.1" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#uploading-packages-using-r"><i class="fa fa-check"></i><b>3.1</b> Uploading packages using R</a><ul>
<li class="chapter" data-level="3.1.1" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#set-environment"><i class="fa fa-check"></i><b>3.1.1</b> Set environment</a></li>
<li class="chapter" data-level="3.1.2" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#set-token"><i class="fa fa-check"></i><b>3.1.2</b> Set token</a></li>
<li class="chapter" data-level="3.1.3" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#what-is-in-a-package"><i class="fa fa-check"></i><b>3.1.3</b> What is in a package?</a></li>
<li class="chapter" data-level="3.1.4" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#about-identifiers"><i class="fa fa-check"></i><b>3.1.4</b> About identifiers</a></li>
<li class="chapter" data-level="3.1.5" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#publishing-a-package-to-the-site"><i class="fa fa-check"></i><b>3.1.5</b> Publishing a package to the site</a></li>
<li class="chapter" data-level="3.1.6" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#exercise2"><i class="fa fa-check"></i><b>3.1.6</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#uploading-a-new-version"><i class="fa fa-check"></i><b>3.2</b> Uploading a new version</a><ul>
<li class="chapter" data-level="3.2.1" data-path="using-arcticdatautils.html"><a href="using-arcticdatautils.html#exercise3"><i class="fa fa-check"></i><b>3.2.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="system-metadata.html"><a href="system-metadata.html"><i class="fa fa-check"></i><b>4</b> System metadata</a><ul>
<li class="chapter" data-level="4.1" data-path="system-metadata.html"><a href="system-metadata.html#introduction"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="system-metadata.html"><a href="system-metadata.html#editing-sysmeta"><i class="fa fa-check"></i><b>4.2</b> Editing sysmeta</a><ul>
<li class="chapter" data-level="4.2.1" data-path="system-metadata.html"><a href="system-metadata.html#exercise4"><i class="fa fa-check"></i><b>4.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="system-metadata.html"><a href="system-metadata.html#editing-sysmeta-on-lots-of-files"><i class="fa fa-check"></i><b>4.3</b> Editing sysmeta on lots of files</a></li>
<li class="chapter" data-level="4.4" data-path="system-metadata.html"><a href="system-metadata.html#identifiers-and-sysmeta"><i class="fa fa-check"></i><b>4.4</b> Identifiers and sysmeta</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html"><i class="fa fa-check"></i><b>5</b> Editing EML in R</a><ul>
<li class="chapter" data-level="5.1" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#introduction-1"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#making-edits"><i class="fa fa-check"></i><b>5.2</b> Making edits</a><ul>
<li class="chapter" data-level="5.2.1" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#setting-attributes"><i class="fa fa-check"></i><b>5.2.1</b> Setting attributes</a></li>
<li class="chapter" data-level="5.2.2" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#setting-other-entities"><i class="fa fa-check"></i><b>5.2.2</b> Setting other entities</a></li>
<li class="chapter" data-level="5.2.3" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#setting-coverages"><i class="fa fa-check"></i><b>5.2.3</b> Setting coverages</a></li>
<li class="chapter" data-level="5.2.4" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#setting-methods"><i class="fa fa-check"></i><b>5.2.4</b> Setting methods</a></li>
<li class="chapter" data-level="5.2.5" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#adding-people"><i class="fa fa-check"></i><b>5.2.5</b> Adding people</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#validating-and-writing-the-eml"><i class="fa fa-check"></i><b>5.3</b> Validating and writing the EML</a></li>
<li class="chapter" data-level="5.4" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#dealing-with-unusual-cases"><i class="fa fa-check"></i><b>5.4</b> Dealing with unusual cases</a></li>
<li class="chapter" data-level="5.5" data-path="editing-eml-in-r.html"><a href="editing-eml-in-r.html#exercise5"><i class="fa fa-check"></i><b>5.5</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html"><i class="fa fa-check"></i><b>6</b> Using git in RStudio</a><ul>
<li class="chapter" data-level="6.1" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#introduction-2"><i class="fa fa-check"></i><b>6.1</b> Introduction</a><ul>
<li class="chapter" data-level="6.1.1" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#so-why-do-i-need-to-use-this-again"><i class="fa fa-check"></i><b>6.1.1</b> So why do I need to use this again?</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#setting-up-git"><i class="fa fa-check"></i><b>6.2</b> Setting up git</a><ul>
<li class="chapter" data-level="6.2.1" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#cloning-the-arctic-data-repo"><i class="fa fa-check"></i><b>6.2.1</b> Cloning the arctic-data repo</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#working-with-the-repository"><i class="fa fa-check"></i><b>6.3</b> Working with the repository</a><ul>
<li class="chapter" data-level="6.3.1" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#adding-a-new-script"><i class="fa fa-check"></i><b>6.3.1</b> Adding a new script</a></li>
<li class="chapter" data-level="6.3.2" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#editing-a-script"><i class="fa fa-check"></i><b>6.3.2</b> Editing a script</a></li>
<li class="chapter" data-level="6.3.3" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#where-do-i-commit"><i class="fa fa-check"></i><b>6.3.3</b> Where do I commit?</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="using-git-in-rstudio.html"><a href="using-git-in-rstudio.html#my-git-tab-disappeared"><i class="fa fa-check"></i><b>6.4</b> My Git tab disappeared</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html"><i class="fa fa-check"></i><b>7</b> Introduction to Solr</a><ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#querying-solr"><i class="fa fa-check"></i><b>7.1</b> Querying Solr</a><ul>
<li class="chapter" data-level="7.1.1" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#parts-of-a-query"><i class="fa fa-check"></i><b>7.1.1</b> Parts of a Query</a></li>
<li class="chapter" data-level="7.1.2" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#constructing-a-query"><i class="fa fa-check"></i><b>7.1.2</b> Constructing a Query</a></li>
<li class="chapter" data-level="7.1.3" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#faceting"><i class="fa fa-check"></i><b>7.1.3</b> Faceting</a></li>
<li class="chapter" data-level="7.1.4" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#stats"><i class="fa fa-check"></i><b>7.1.4</b> Stats</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#querying-solr-through-r"><i class="fa fa-check"></i><b>7.2</b> Querying Solr through R</a></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#key-takeaways"><i class="fa fa-check"></i><b>7.3</b> Key takeaways</a></li>
<li class="chapter" data-level="7.4" data-path="introduction-to-solr.html"><a href="introduction-to-solr.html#more-resources"><i class="fa fa-check"></i><b>7.4</b> More resources</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">NCEAS Data Team Training</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-arcticdatautils" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Using arcticdatautils</h1>
<p>New data team members should complete exercises <a href="using-arcticdatautils.html#exercise2">two</a> and <a href="using-arcticdatautils.html#exercise3">three</a> as part of training.</p>
<div id="uploading-packages-using-r" class="section level2">
<h2><span class="header-section-number">3.1</span> Uploading packages using R</h2>
<p>We will be using the arcticdatautils package and the dataone package to connect to the <a href="arcticdata.io">NSF Arctic Data Center</a> data repository and push and pull edits. To identify yourself as admin you will need to register a ‘token’ by signing in to the ADC with your <a href="https://orcid.org/register">ORCiD</a>, copying your token into R and telling R where to connect by defining the member node using the code below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(arcticdatautils)
<span class="kw">library</span>(dataone)</code></pre></div>
<div id="set-environment" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Set environment</h3>
<p>Once we have our libraries loaded we need to tell R which repo we want to be working with. If we are working on the production site, you can set the coordinating node (<code>cn</code>) and member node (<code>mn</code>) this way:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cn &lt;-<span class="st"> </span><span class="kw">CNode</span>(<span class="st">&#39;PROD&#39;</span>)
mn &lt;-<span class="st"> </span><span class="kw">getMNode</span>(cn,<span class="st">&#39;urn:node:ARCTIC&#39;</span>)</code></pre></div>
<p>If we are working in the test environment, we set it this way:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cn &lt;-<span class="st"> </span><span class="kw">CNode</span>(<span class="st">&#39;STAGING&#39;</span>)
mn &lt;-<span class="st"> </span><span class="kw">getMNode</span>(cn,<span class="st">&#39;urn:node:mnTestARCTIC&#39;</span>)</code></pre></div>
<p>A note on nodes - be very careful about what you publish on the production node (PROD, or arcticdata.io). This node should NEVER be used to publish test or training datasets. While going through training exercises, you should be using the test environment (STAGING, or test.articdata.io).</p>
</div>
<div id="set-token" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Set token</h3>
<p>Now that we have the environment set we have to manually log in to the NSF ADC site to get our token and copy it to our R environment. <strong>This token is your identity on these sites, please treat it as you would a password</strong> (ie. don’t paste into scripts that will be shared). The easiest way to do this is to just run the token in the <em>console</em>. There’s no need to keep it in you script since its temporary anyway. Sometimes you’ll see a placeholder in scripts to remind users to get their token, such as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">dataone_test_token =</span> <span class="st">&quot;...&quot;</span>)</code></pre></div>
</div>
<div id="what-is-in-a-package" class="section level3">
<h3><span class="header-section-number">3.1.3</span> What is in a package?</h3>
<p>A data package generally consists of at least 3 “objects” or files. One object is the metadata file itself. Ths file is in XML format, and has the extension <code>.xml</code>. We sometimes refer to this file as the EML, which is the metadata standard that it uses. Another object or objects are the data files themselves. Most commonly these are data tables (<code>.csv</code>), but they can also be audio files, netCDF files, plain text files, pdf documents, image files, etc. The final object is the resource map. This object is a text file that defines the relationships between all of the other objects in the data package. It says things like “this metadata file describes this data file,” and is critical to making a data package render correctly on the website with the metadata files and all of the data files in te right place. Fortunately, we rarely if ever have to actually look at the contents of resource maps, they are generated for us using <code>arcticdatautils</code>.</p>
</div>
<div id="about-identifiers" class="section level3">
<h3><span class="header-section-number">3.1.4</span> About identifiers</h3>
<p>Each object (metadata files, data files, resource maps) on the Artic Data Center or KNB has a unique identifier, also sometimes called a “pid”. When you look at the landing page for a dataset, for example <a href="https://arcticdata.io/catalog/#view/resource_map_doi:10.18739/A2836Z">here</a>, you can find the resource map identifier in the URL (<code>resource_map_doi:10.18739/A2836Z</code>), the metadata identifer in the “General &gt; Identifier” section of the metadata record (<code>doi:10.18739/A2836Z</code>), and the data identifier by clicking the “more info” link next to the data object, and looking at the “online distribution info” section (<code>arctic-data.9546.1</code>).</p>
<p>Different versions of a package are linked together by what we call the version chain. Making an update to a data package, such as replacing a data file, changing a metadata record, etc, will result in a new identifier for the object that was updated. When making changes to a package, always use the <code>update_object</code> or <code>publish_update</code> commands from <code>arcticdatautils</code> to ensure that the version chain is maintained.</p>
</div>
<div id="publishing-a-package-to-the-site" class="section level3">
<h3><span class="header-section-number">3.1.5</span> Publishing a package to the site</h3>
<p>Objects are published to the site using a function called <code>publish_object</code>. To publish a metadata file you would use the following call:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meta_path &lt;-<span class="st"> &#39;path/to/your/metadata/metadata.xml&#39;</span>
pid &lt;-<span class="st"> </span><span class="kw">publish_object</span>(mn, meta_path, <span class="dt">format_id =</span> <span class="kw">format_eml</span>())</code></pre></div>
<p>This call will save the id of the metadata object to the variable <code>pid</code>, which you will need later for the resource map. It also adds a formatID, which identifies what kind of object you just uploaded. Similarly, you can publish data objects like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data_path &lt;-<span class="st"> &#39;path/to/your/data/data.csv&#39;</span>
data_pid &lt;-<span class="st"> </span><span class="kw">publish_object</span>(mn, data_path, <span class="dt">format_id =</span> <span class="st">&#39;text/csv&#39;</span>)</code></pre></div>
<p>Note that you will need to be explicit about your <code>format_id</code> here based on the file type. A list of format IDs can be found <a href="https://cn.dataone.org/cn/v2/formats">here on the DataONE website</a>.</p>
<p>Finally, you can create and publish the resource map using <code>create_resource_map</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rm &lt;-<span class="st"> </span><span class="kw">create_resource_map</span>(mn, pid, <span class="dt">data_pids =</span> data_pid)</code></pre></div>
<p>One final step is to make sure that the rights and access on thes objects you uploaded are set correctly. The function <code>set_rights_and_access</code> will set both, and <code>set_access</code> will just set access. There are two functions for this because a rights holder should always have access, but not all people who need access are rights holders. The rights holder to the dataset is typically the submitter (if the dataset is submitted through the registry), but if a data team intern is publishing objects for a PI, the rights holder is the main point of contact for the dataset (ie the person who requested that we upload the data for them). In this example, we set rights and access for all of the objects created above, using an example ORCID.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set_rights_and_access</span>(mn, 
                      <span class="kw">c</span>(pid, data_pid, rm), 
                      <span class="dt">subject =</span> <span class="st">&#39;http://orcid.org/PUT0-YOUR-ORCD-HERE&#39;</span>,
                      <span class="dt">permissions =</span> <span class="kw">c</span>(<span class="st">&#39;read&#39;</span>, <span class="st">&#39;write&#39;</span>, <span class="st">&#39;changePermission&#39;</span>))</code></pre></div>
</div>
<div id="exercise2" class="section level3">
<h3><span class="header-section-number">3.1.6</span> Exercise</h3>
<ul>
<li>Locate the data package you published by navigating to the “my profile” section on <a href="test.arcticdata.io" class="uri">test.arcticdata.io</a>.</li>
<li>Download the metadata and data files and transfer them to the datateam server.</li>
<li>Using the functions described in the section above, pubish your metadata record and data file to the site.</li>
<li>View your new dataset (which is identical to the one you created previously) by appending the pid of your resource map (in the example above, the resource map pid was saved to the variable <code>rm</code>) to the end of the URL test.arcticdata.io/#view/…</li>
</ul>
</div>
</div>
<div id="uploading-a-new-version" class="section level2">
<h2><span class="header-section-number">3.2</span> Uploading a new version</h2>
<p>To edit material, we use the <code>publish_update</code> or <code>update_object</code> functions in <code>arcticdatautils</code>.</p>
<p>Usually we’ll be updating exisiting work using <code>publish_update()</code> from the arcticdatautils package, which has an argument for adding data PIDs (or otherwise including existing data PIDs to make sure that they stay with the package). This function allows you to add or remove data objects, and/or make metadata edits.</p>
<p>The following example shows how you would add a data file to a package, and make a change to the metadata file.</p>
<p>First, make whatever edits you ned to make to the metadata, and save them to the server.</p>
<p>Define the path to your metadata.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">meta_path &lt;-<span class="st"> &quot;path/to/metadata/file.xml&quot;</span></code></pre></div>
<p>Use either the metadata or resource map pid for your existing data package and the function <code>get_package</code> to return all of the existing pids in the data package as a named list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># the function get_package is helpful to get all other PIDs in a package if you know the metadata PID</span>
metaPid &lt;-<span class="st"> &quot;urn:uuid:5933a052-5493-4f50-8622-ed83231d3fee&quot;</span>
ids &lt;-<span class="st"> </span><span class="kw">get_package</span>(mn, metaPid)</code></pre></div>
<p>Finally, use the <code>publish_update</code> function with the results of the lines above to update your data package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">publish_update</span>(mn,
               <span class="dt">metadata_pid =</span> metaPid <span class="co"># old metadata PID you pulled in originally. Alternatively could paste in the string:  &quot;urn:uuid:a592a9a2-547c-48ee-bff2-add133aa64ee&quot;</span>
               <span class="dt">resource_map_pid =</span> ids$resource_map,
               <span class="dt">metadata_path =</span> meta_path, <span class="co"># path to updated EML file,</span>
               <span class="dt">data_pid =</span> ids$data, <span class="co"># this can also be 2+ by including the PIDs in a vector c(pid1, pid2,pid3)</span>
               <span class="dt">check_first =</span> T,
               <span class="dt">use_doi =</span> <span class="ot">FALSE</span>,
               <span class="dt">public =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>If a package is ready to be public, note that you can change the <code>public</code> argument in the <code>publish_update</code> call to <code>TRUE</code>. Similarly, if you want to publish with a DOI type identifier instead of a UUID type identifer, you can change the <code>use_doi</code> argument to <code>TRUE</code>.</p>
<div id="exercise3" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Exercise</h3>
<ul>
<li>Locate the data package you published in the previous exercise by navigating to the URL test.arcticdata.io/#view/… with the resource map pid you generated in that exercise.</li>
<li>Download the EML to your computer, and open it in a plain text editor (TextEdit or Atom).</li>
<li>Navigate to the title section, and make a change to the title text within the <code>&lt;title&gt;</code>…<code>&lt;/title&gt;</code> section.
<ul>
<li>Do not change the <code>&lt;title&gt;</code> or <code>&lt;/title&gt;</code> syntax. Upload the file back to the datateam server.</li>
</ul></li>
<li>Using the <code>publish_update</code> function, update your data package as shown above.</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-open-science.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="system-metadata.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
